<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE book PUBLIC "-//OASIS//DTD DocBook XML V4.3//EN"
                      "http://www.oasis-open.org/docbook/xml/4.3/docbookx.dtd"
[ 
	<!ENTITY % wdb.entities SYSTEM "../docbook/wdb_entities.ent">
	%wdb.entities;
]
>

<book>
	<title>WDB Call Interface User Manual</title>
	
	<bookinfo>
		<editor>
			<firstname>Michael</firstname>
			<othername>O.</othername>
			<surname>Akinde</surname>
			
			<affiliation>
				<orgname> <ulink url="http://www.met.no">met.no</ulink>
				</orgname>
				
				<address>
          <street>Niels Henrik Abelsvei 4</street> 
          <city>Oslo</city>
          <country>Norway</country>
          <email>wdb@met.no</email>
        </address>
			</affiliation>
		</editor>
		<abstract>
			
			<para>WDB is a data storage solution for weather and water data based on the
				PostgreSQL object-relational database system. The system utilizes
				PostGIS for GIS (Geographic Information Systems) support and handles
				regular grids (e.g., forecast fields) and point (e.g., observation)
				data.</para>
			
			<para>This is the User's Manual for WDB Call Interface of WDB version
				&version;</para>
			
		</abstract>
	</bookinfo>
	
	<chapter id="cha:wci_introduction">
		<title>Introduction</title>
		
		<para>The WDB Call Interface (WCI) is the official API used for retrieving data from
			the WDB system.</para>
		
		<sect1 id="sec:about_manual">
			<title>About this Manual</title>
			
			<para>This manual is intended for system designers, application developers
				and programmers. It describes in technical terms how weather data can be
				retrieved from the WDB system through the WCI. It is assumed that the reader
				has some familiarity with databases and weather data.</para>
			
			<para>For a more elaborate description of the vision and system architecture of
				the WDB system, see the WDB Developer's Manual.</para>
			
		</sect1>
		
		<sect1 id="sec:intended_usage">
			<title>Intended Usage</title>
			
			<para>WCI is intended to be used for retrieving weather data (e.g.,
				temperature, air pressure, etc.) for a geographic point or area, given an
				altitude interval and a time or time interval. It is possible to retrieve
				individual data values or huge quantities of data using a single
				API.</para>
			
		</sect1>
		
		<sect1 id="sec:wci_outline">
			<title>Outline</title>
			
			<para>This document is structured as follows:</para>
			
			<itemizedlist>
				<listitem>
					<para>Key Concepts: introduction to the concepts and terms used in the
						documentation</para>
				</listitem>
				<listitem>
					<para>Using the WCI: an introduction to how the WCI is used</para>
				</listitem>
				<listitem>
					<para>Function Reference: reference documentation for each of the
						WCI functions</para>
				</listitem>
				<listitem>
					<para>Data Types Reference: reference documentation for the WCI data
						types</para>
				</listitem>
				<listitem>
					<para>Examples: Example programs for WCI</para>
				</listitem>
				<listitem>
					<para>FAQ: Frequently asked questions</para>
				</listitem>
				<listitem>
					<para>Known bugs and limitations</para>
				</listitem>
			</itemizedlist>
			
		</sect1>
		
	</chapter>
	
	<chapter id="cha:key_concepts">
		<title>Key Concepts</title>
		
		<para>This section provides an overview of the WCI, including some important
			definitions and explanations.</para>
		
		<sect1 id="sec:wci_overview">
			<title>Overview</title>
			
			<para>WCI is an API designed to retrieve weather data from the WDB system. The WCI
				API resides on the database server.</para>
			
			<para>All function calls on WCI are executed as SQL statements. The SQL
				statements can be executed through a dedicated SQL client application,
				such as psql, pgadmin3, DbVisualizer, or by an application program through
				a database API such as JDBC, ODBC, libpqxx, etc. The WCI is thus not linked
				into the application program itself, but is a component of the
				database.</para>
			
			<para>A data item in WDB could be an observation, a forecast, an analysis, etc.
				Each item consists of a value and a number of dimensions that describe the
				value.</para>
			
			<para>A dimension could be a description of the data item (e.g., temperature),
				its geographic position, its altitude (or depth), the time the data item was
				created, the origin of the data item, etc.</para>
			
			<para>In order to access the data items in WDB, the user should have an understanding of the
				dimensions as they are the entry point into the database. When data is retrieved from
				the database, a set of search criteria is given for each of the
				WCI dimensions. If the search criteria for a dimension is
				not specified (i.e., all NULLs), it is assumed the user wants to retrieve all data items,
				regardless of their dimension description. Please do not attempt this unless the database 
				you are querying is extremely small.</para>
				
			<para>In the context of WCI search criteria, NULL is always interpreted to mean "ALL".</para>
			
			<para>The last parameter of a WCI function call that is intended to return data is always
			reserved for specifying the data type to be returned (this is because most functions are 
			overloaded to return many different forms of data. By convention, this parameter is 
			usually given as a NULL cast to the relevant data type; for example:</para>

			<programlisting>
NULL::wci.browsereferencetime
		</programlisting>
			
			<para>The dimensions are described in the following sections.</para>
			
		</sect1>
		
		<sect1 id="sec:data_provider">
			<title>Data Provider</title>
			
			<para>The Data Provider identifies the source of the data; literally,
				<emphasis>the entity that provides the data</emphasis>. Where multiple
				sources could be identified as the source of the data, the entity that can be
				identified closest to the creation of the data item at the time of loading is
				usually used.</para>
			
			<para>A data provider can be a software process (e.g., Hirlam), a
				meteorological or climate station, an aircraft, or a person. A data provider 
				is identified by a DataProviderName. DataProviderNames are 
				used to search for the data. For convenience, Data Providers may be
				collected into groups; e.g., the DataProviderName "Hirlam" might be used
			    to search for any of the various Hirlam processes: "Hirlam 4", "Hirlam 8", 
				etc.</para>
			
			<para>When searching for data, the user may specify a single DataProviderName,
				a list of DataProviderNames (specified using an ARRAY constructor), or NULL. 
				NULL indicates that the user wants all 	data items, regardless of the data 
				source.</para>

			<para>DataProviderNames exist within a data provider namespace. A namespace can be defined by
				the WDB administrator, in order to permit the user or an application to retrieve data in
				an accustomed language or code set. The default namespace of WDB is the DataProviderNameSpaceId
				0, and is always based on English language names and international standard codes. The 
				data provider namespace being used in a querying session can be defined by the user when
				starting up the session.
			</para>
			
			<para>To retrieve all of the DataProviderNames (excluding data provider groups) that are
				currently stored in the database for the currently specified namespace, the following 
				wci.browse function call could be used:</para>
			
			<programlisting>
SELECT * FROM wci.browse( NULL::wci.browsedataprovider );
		</programlisting>

			<para>To retrieve all of the DataProviderNames (including data provider groups) that the
				database currently has the capacity to store and display in the currently specified
				namespace, the following wci.info function call could be used:</para>
			
			<programlisting>
SELECT * FROM wci.info( NULL, NULL::wci.infodataprovider );
		</programlisting>
									
		</sect1>
		 
		<sect1 id="sec:place">
			<title>Place (Geographic Location)</title>
			
			<para>The place (geographic location) of a data item is the position of the item
				on the earth in a 2D space. In WDB, the geographic location is by default
				specified using longitude and latitude in a WGS84 coordinate system
				(though this can be changed when the database is set up; consult your system
				administrator). The geographic dimension is specified using a geometry
				object and can be either a point or a polygon.</para>
			
			<para>In addition to using geometry objects to retrieve data, the user can also
				use a PlaceName - a pre-specified name that defines a geometry object in the
				database - to specify location.</para>

			<para>As for DataProviderName, PlaceNames exist within a place namespace that can be defined
				by the WDB administrator. The default namespace of WDB is the PlaceNameSpaceId 0; defined
				in international english. As for the data provider namespace, the place namespace can be 
				defined by the user when starting up the session. 
			</para>
			
			<para>To retrieve the full list of the PlaceNames for the data values currently being stored
			in the database, use the following wci.browse function call:</para>

			<programlisting>
SELECT * FROM wci.browse( NULL::wci.browseplace );
		</programlisting>
									
			<para>At the same time as the user specifies a location to retrieve data from, it
				is also possible to specify an interpolation option for location
				calculations. These permit the user a great deal of flexibility in
				searching. Currently, interpolations such as "exact", "nearest" (retrieve the
			data value closest to the specified place), and "bilinear" (retrieve the closest data
			values and perform a bilinear interpolation of those values) are implemented.</para>
			
			<para>The form of place specification then becomes one of the two following:</para>
			
			<programlisting>
'Oslo'
		</programlisting>
			<programlisting>
'nearest Oslo'
		</programlisting>
			<programlisting>
'POINT(61 9)'
		</programlisting>
			<programlisting>
'bilinear POINT(61 9)'
		</programlisting>
			
			<para>Specifying NULL for the place definition of a query is logically
				equivalent to asking for all of the data items in the database, irrespective
				of their location.</para>
			
			<para>To retrieve all of the place names that are currently registered in the database,
				the following WCI function call can be used:</para>
			
			<programlisting>
SELECT * FROM wci.info( NULL, NULL::wci.infoplace );
		</programlisting>

		</sect1>
		
		<sect1  id="sec:reftime">
			<title>Reference Time</title>
			
			<para>The reference time of a data item is the moment when the data item is
				referenced from. For forecast data, this would typically be the reference
				time of the data values the forecast is based upon; for observation data,
				it would typically be the time when the observation data was recorded.</para>
			
			<para>When searching for data, the user specifies the reference time (with time
				zone), or NULL. NULL indicates that the user wants all data items,
				regardless of the reference time of the data. Time is specified in WCI as
			    a text string with datetime's that are interpreted by the WCI parser.</para>

			<para>To retrieve a list of the reference times currently being stored in the
				database, use the wci.browse functionality:</para>
			
			<programlisting>
SELECT * FROM wci.browse( NULL::wci.browsereferencetime );
		</programlisting>
			
			<para>In addition to time points, it is also possible for the user to specify time periods 
			using a variety of keywords. The keywords are: exact (default), before, after, inside, and contains. 
			And interval can be specified using two timestamps and separating them with the keyword TO, or a 
			timestamp and a duration separated by the keyword FOR. As examples, consider:
			</para>
			
			<programlisting>
exact 2009-03-31T11:20:00+00
		</programlisting>
		
			<para>Denotes the specific time point of 11:20 UTC, on the 31st of March, 2009. The keyword 
			"exact" is actually redundant, as this is the default interpretation of a timestamp in
			WCI.</para>
			
			<programlisting>
before 2009-03-31T11:20:00+00
		</programlisting>
		
			<para>Denotes that the user wants to return all data for the time period prior to the time 
			point of 11:20 UTC, on the 31st of March, 2009.</para>
			
			<programlisting>
after 2009-03-31T11:20:00+00
		</programlisting>
		
			<para>Denotes that the user wants to return all data for the time period after the time 
			point of 11:20 UTC, on the 31st of March, 2009.</para>
			
			<programlisting>
inside 2009-03-31T11:20:00+00 TO 2009-05-31T11:20:00+00 
		</programlisting>
		
			<para>Denotes that the user wants to return all data inside the time period between the time 
			point of 11:20 UTC, on the 31st of March, 2009 and the same time two months later.</para>
			
			<programlisting>
inside 2009-03-31T11:20:00+00 FOR 2 months 
		</programlisting>
		
			<para>Denotes that the user wants to return all data inside the time period between the time 
			point of 11:20 UTC, on the 31st of March, 2009 and the same time two months later.</para>
			
		</sect1>
				
		<sect1 id="sec:validtime">
			<title>Valid Time</title>
			
			<para>The valid time of a data item is the time period for which the data item is
				valid. The valid time is always stored in the database as a time interval.</para>
			
			<para>When searching for data, the user specifies the valid time (with time
				zone), or NULL. NULL indicates that the user wants all data items,
				regardless of the valid time of the data. Time is specified in WCI as
			    a text string with datetime's that are interpreted by the WCI parser.</para>

			<para>Time is specified in the same way for time periods as for time points. Examples of
			how the qualifiers should be interpreted are given below:</para>

			<programlisting>
exact 2009-03-31T11:20:00+00 TO 2009-05-31T11:20:00+00 
		</programlisting>
			
			<para>The exact keyword returns only time periods that match precisely with the time period specified.
			</para>
			
			<programlisting>
before 2009-03-31T11:20:00+00
		</programlisting>
		
			<para>The before keyword returns only time periods that end before the specified time
			point. In other words, the time period from 2009-03-29 to 2009-03-30 would be returned by the query
			but the time period from 2009-03-29 to 2009-04-01 would not.</para>
			
			<programlisting>
after 2009-03-31T11:20:00+00
		</programlisting>
		
			<para>The after keyword returns only time periods that start after the specified time point</para>
			





			<programlisting>
inside 2009-03-31T11:20:00+00 TO 2009-05-31T11:20:00+00 
		</programlisting>
		
			<para>Denotes that the user wants to return all data inside the time period between the time 
			point of 11:20 UTC, on the 31st of March, 2009 and the same time two months later.</para>
			
			<programlisting>
inside 2009-03-31T11:20:00+00 TO 2009-05-31T11:20:00+00 
		</programlisting>
		

			<programlisting>
SELECT * FROM wci.browse( NULL::wci.browsevalidtime );
		</programlisting>
			
		</sect1>
		
		<sect1 id="sec:value_parameter">
			<title>Value Parameter</title>
			
			<para>Each data value can be described using a "value parameter". The value
				parameter is a name that describes the physics or code table basis of the
				parameter value. The value parameter concept in WCI is broadly similar to
				the concept of meteorological parameter used in, e.g., GRIB files.</para>
						
			<para>The user searches the database for a specific parameter in the database
			using the ValueParameterName. ValueParameterNames are specified within a 
			parameter namespace. As with the other namespaces, the ParameterNameSpaceId 0
			is reserved for the default WDB namespace, and is based on international 
				english. Additional namespaces can be defined by the administrator of the
				database.
			</para>
			
			<para>To retrieve a list of the value parameters currently being stored in the
				database, use the wci.browse functionality:</para>
			
			<programlisting>
SELECT * FROM wci.browse( NULL::wci.browsevalueparameter );
		</programlisting>
			
		</sect1>
		
		<sect1 id="sec:level">
			<title>Level (Altitude)</title>
			
			<para>The <emphasis>Level</emphasis> dimension is used to designate the
				altitude or depth of the data value. Level is designated using a level interval (height 
				from and to) and a level parameter (e.g., height above sea level, pressure). The level
				definition can be prefixed with a level interpolation option that permits the
				user a large degree of flexibility in expressing searches. Levels are specified using
				a level specification in string form that is parsed by the WCI.</para>
			
			<para>Specifying <emphasis>ANY</emphasis> for the level interpolation is
				logically equivalent to specifying a NULL for the level; i.e., it retrieves
				all data items regardless of their level (height).</para>

			<para>The level parameter is specified using a LevelParameterName. LevelParameterNames
				are specified within the parameter namespace. Consequently, it is not possible
				to mix usage of ValueParameterNames and LevelParameterNames from different namespaces
				without defining a new parameter namespace. The default WDB ParameterNameSpaceId is 0
				and is based on international english. 
			</para>
			
			<para>To retrieve a full list of the level parameters currently being stored in the
				database, use the wci.browse functionality:</para>
			
			<programlisting>
SELECT * FROM wci.browse( NULL::wci.browselevelparameter );
		</programlisting>
						
		</sect1>
		
		<sect1 id="sec:data_version">
			<title>Data Version</title>
			
			<para>There can be several different versions of the same data value that is
				valid for the same time, position, etc. This can happen with probability
				forecast calculations or when a data value is edited (in which case the new
				value may often be inserted with a higher data version). A data version is
				always a positive whole number.</para>
			
			<para>The user may specify one or several data versions as search criteria in
				WCI, as well as NULL. NULL indicates that the user wants all versions of the
				data items specified. In addition, the user may specify the data version as
				a negative number; e.g., <emphasis>-1</emphasis>. Specifying <emphasis>-1</emphasis>
				retrieves the maximum data version in the database (i.e., the most recent version of the data item), 
				<emphasis>-2</emphasis> retrieves the second most recent, and so on.</para>
			
			<para>There is no wci.browse functionality to list all of the data versions of the data in the 
			database.</para>
			
		</sect1>
		
	</chapter>
	
	<chapter id="cha:using_wci">
		<title>Using the WCI</title>
		
		<para>This section gives an overview on how to use the WCI to retrieve data values from
			WDB.</para>
		
		<sect1 id="sec:using_outline">
			<title>Outline</title>
			
			<para>The following list provides a brief overview of the actions that the user
				takes in order to retrieve data from WCI.</para>
			
			<itemizedlist>
				<listitem>
					<para>Create a connection to the database</para>
				</listitem>
				<listitem>
					<para>Initialize WCI</para>
				</listitem>
				<listitem>
					<para>Read data from WDB using WCI functions (one or more times)</para>
				</listitem>
				<listitem>
					<para>Release WCI</para>
				</listitem>
				<listitem>
					<para>Close database connection</para>
				</listitem>
			</itemizedlist>
			
		</sect1>
		
		<sect1 id="sec:open_connection">
			<title>Open a connection</title>
			
			<para>To enable communication with WCI, the user must open a connection to the
				database. How this is done depends very much on the application or API that is
				being used (consult the documentation of the program or API for
				information).</para>
			
			<para>Using libpq,</para>
			
			<programlisting>
connection_ = PQconnectdb("dbname=wdb user=myuser host=localhost");
		</programlisting>
			
			<para>The connection must be open and valid as long as commands are being sent and
				data retrieved from the database. It is worth noting that connections are a
				resource; the database will have limits on how many connections
				can be open at the same time. This is particularly important for massively
				multi-user applications (e.g., web applications). In such cases, the
				database connections must be managed with some care. There is also an amount 
			overhead involved with setting up a connection, so it will always be more efficient 
			to connect once and perform multiple database operations, than to connect repeatedly
			for each operation.</para>
						
		</sect1>
		
		<sect1 id="sec:initialize_wci">
			<title>Initialize WCI</title>
			
			<para>Before WCI may be used by the user, it must be initialized.</para>
			
			<programlisting>
SELECT wci.begin('myuser'::name, 0::integer, 0::integer, 0::integer);
		</programlisting>
			
			<para>The username is used to identify the user with WCI (this is used in setting
				up internal WCI variables). The three following numbers are the namespace
				codes for data provider namespace, place name space, and parameter name space.
				The wci.begin can also be called without setting these three variables, in 
				which case they are set to the default (usually 0, 0, 0) by the system.</para>
			
			<para>The username of the wci user can be a different identity than the one the
				user connected with (always assuming, of course, that your user has
				appropriate rights). This allows, for instance, for a single system to act
				as a multiplexing front-end to retrieve data available from several
				distinct users.</para>

			<para>Name spaces are used to identify what set of names should be used for searching 
				the database. While the user is in a namespace, only the data defined in that
				namespace is visible to the user. If the user should wish, for some reason, to
				combine data from different namespaces within an application, it will be necessary
				to call wci.begin repeatedly; once for each time the application needs to change its
				namespace.
				</para>
						
		</sect1>
		
		<sect1 id="sec:reading_wci">
			<title>Read from the WCI</title>
			
			<para>As soon as the user has initialized WCI using wci.begin, the database is
				ready for retrieval of data. Data is retrieved using the wci.read function,
				and data is searched for by setting the appropriate dimensions in that
				call.</para>
			
		<sect2 id="sec:reading_wci_point">
			<title>Reading Point Data from WCI</title>

			<para>The wci.read function is overloaded to permit the user to read either point data or binary data (entire grids)
				from the database. The last parameter in the wci.read function allows the user to specify the return type of 
				the query. To return point data values, the user specifies wci.returnFloat.</para>
			
			<programlisting>
SELECT * 
FROM wci.read ( ARRAY['hirlam norway'], -- Data provider name
				'POLYGON((10 60,11 60,11 61,10 61,10 60))',  -- Location
				'inside 1980-01-01 12:00:00Z TO 1980-01-01 18:00:00Z', -- Reference time 
				NULL, -- Valid Time 
				ARRAY['air temperature'],  -- Value Parameter
				'2 height above ground distance',  -- Level
				ARRAY[-1], -- Data version
				NULL::wci.returnfloat -- Return type
			  )
		</programlisting>
			
			<para>The above query returns Hirlam data for a specific region (given by the place
				geometry), whose referencetime is on or between 12:00 to 18:00 on January
				1, 1980; the query will return data for any valid times, for any air temperature.
				It will return data at 2 metre above ground, but only the latest version of such data.
				Values will be returned as point data.</para>
			
			<para>The data provider, place definition, value parameter and level parameter must all
			be defined within the namespaces given in the wci.begin call that preceded the wci.read
			call. In this particular case, the place definition is a geometry definition, but it would
			also have been possible to use a placename. Consider, for example, the following query:</para>

			<programlisting>
SELECT * 
FROM wci.read ( ARRAY['hirlam norway'], -- Data provider name
				'oslo',  -- Location
				'1980-01-01 12:00:00Z', -- Reference time 
				'inside 1980-01-02 12:00:00 TO 1980-01-12 12:00:00', -- Valid Time 
				ARRAY['%precipitation%'],  -- Value Parameter
				NULL,  -- Level
				NULL, -- Data version
				NULL::wci.returnfloat -- Return type
			  )
		</programlisting>
			
			<para>The above call returns all precipitation parameters valid for the 10 days following the 
				given referencetime measured at the nearest point to oslo. Oslo, in this case, is a place name
				usually defined as a geographical point within the database. Prefixing the place name is the 
				interpolation that we wish to use when retrieving points; we could also have used any of the
				alternatives defined in the reference manual below. Note the use of SQL wildcard characters in the
				value parameter; although these slow down queries (since wildcard searching is not as efficient
				as a straight comparison), it is possible to use the wci.read call in this way. Note also that names 
				can be written in upper or lower case; the wci.read function call is not case-sensitive.</para>
						
			</sect2>

			<sect2 id="sec:reading_wci_grid">
			<title>Reading Grid Data from WCI</title>

			<para>Reading grid data from the database is a two-step process. First the user retrieves the Grid ID with 
				wci.read function (with wci.returnGId), and then the grid itself can be retrieved using the wci.fetch function call.</para>
			
			<programlisting>
SELECT * 
FROM wci.read ( ARRAY['hirlam norway'],    -- Data provider name
				'hirlam 10km grid',          -- Location description
				'1980-01-01 12:00:00Z',    -- Reference time 
				NULL,                      -- Valid Time (returns all forecasts) 
				ARRAY['air temperature'],  -- Value Parameter
				'2 height above ground distance',  -- Level
				ARRAY[-1],                 -- Data version
				NULL::wci.returngid        -- Return type
			  )
		</programlisting>
			
			<para>The above query returns the list of grids available for Hirlam data, defined
				on the hirlam 10km grid (i.e., if there were data on 20km or 4km grids, these would
				not be returned), whose referencetime is 12:00 on January 1, 1980. The query will return
				all grid references to air temperature forecasts for the above configuration.</para>
			
			<para>Grid IDs are essentially 8-bit integers, that are then passed to the wci.fetch
				command, as given below:</para>

			<programlisting>
SELECT * 
FROM wci.fetch ( 7411403,          -- Grid ID (bigint)
				 NULL::wci.grid    -- Return Type
				)
		</programlisting>
			
			<para>The above call returns a single row, containing a binary string containing the actual grid data.
				It also includes additional information detailing the configuration of the grid. For details about
			the wci.fetch call, see the function reference.</para>
						
			</sect2>
			
		</sect1>
		
		<sect1 id="sec:release_wci">
			<title>Release WCI</title>
			
			<para>Once the user has finished retrieving data using WCI, it is a good idea to
				close down WCI.</para>
			
			<programlisting>
SELECT wci.end();
		</programlisting>
			
			<para> This is not strictly necessary, but allows the system to graciously
				deallocate resources and reset any settings that may have been changed by
				WCI.</para>
			
		</sect1>
		
		<sect1 id="sec:close_connection">
			<title>Close Connection</title>
			
			<para>Closes down the connection to the database, freeing up the resources on
				the database to be used by other applications.</para>
			
			<para>Using libpq,</para>
			
			<programlisting>
PQfinish(connection_);
		</programlisting>
			
		</sect1>
		
	</chapter>
	
	<chapter id="cha:wci_function_reference">
		<title>Function Reference</title>
		
		<para>The following sections provide a list of the functions available for usage
			through the WDB Call Interface.</para>
		
		<sect1 id="sec:wci.begin">
			<title>wci.begin</title>
			
			<para>The function wci.begin initializes the WDB Call Interface for a
				specified user.</para>
			
			<sect2 id="sec:wci.begin.prereq">
				<title>Prerequisites</title>
				
				<itemizedlist>
					<listitem>
						<para>A connection must be open to the database</para>
					</listitem>
					<listitem>
						<para>The user must have been set up as a WDB user (i.e., have access to one 
							of the wdb user groups</para>
					</listitem>
				</itemizedlist>
			</sect2>
			
			<sect2 id="sec:wci.begin.syntax">
				<title>Syntax</title>
								
				<programlisting>
wci.begin 
(
	user                    name,
	dataproviderNameSpaceId integer,
	placeNameSpaceId        integer,
	parameterNameSpaceId    integer
)
</programlisting>
				
	<programlisting>
wci.begin (
	user                    name
)
</programlisting>
				
			</sect2>
			
			<sect2 id="sec:wci.begin.parameters">
				<title>Parameters</title>
				
				<table frame="all">
					<title>wci.begin parameters</title>
					<tgroup cols="2">
						<colspec align="left"/>
						<colspec align="left"/>
						<thead>
							<row>
								<entry> Parameter </entry>
								<entry> Description </entry>
							</row>
						</thead>
						<tbody>
							<row>
								<entry>user</entry>
								<entry>The userid to initialize the connection
									with</entry>
							</row>
							<row>
								<entry>dataprovidernamespaceid</entry>
								<entry>The namespace to be used for dataprovider
									names in the session</entry>
							</row>
							<row>
								<entry>placenamespaceid</entry>
								<entry>The namespace to be used for place
									names in the session</entry>
							</row>
							<row>
								<entry>parameternamespaceid</entry>
								<entry>The namespace to be used for parameter
									names in the session</entry>
							</row>
						</tbody>
					</tgroup>
				</table>
				
			</sect2>
			
			<sect2 id="sec:wci.begin.result">
				<title>Expected Result</title>
				
				<para>No return expected.</para>
				
			</sect2>
			
			<sect2 id="sec:wci.begin.example">
				<title>Example</title>
				
				<para>An example setting up the user "michael" with the data provider and parameter name
				spaces associated with the code 1, while retaining use of the default place names:</para>
				
				<programlisting>
SELECT wci.begin ( 'michael', 1, 0, 1 );
</programlisting>
								
				<para>Note that the default namespaces can be defined by the WDB administrator. Consequently,
					the user may frequently want to just install using this namespace, which would be donw
				with the following wci.begin call:</para>

				<programlisting>
SELECT wci.begin ( 'michael' );
</programlisting>
								
			</sect2>
			
			<sect2 id="sec:wci.begin.see">
				<title>See Also</title>
				
				<itemizedlist>
					<listitem>
						<para>wci.end</para>
					</listitem>
				</itemizedlist>
			</sect2>
			
		</sect1>

		<sect1 id="sec:wci.browse">
			<title>wci.browse</title>
			
			<para>The wci.browse function is utilized to browse the meteorological, 
				hydrological and oceanographic data in the database. Essentially, it 
				can be used to retrieve summary data about what data values exist in
				the database. The function takes as input the same search parameters as the
				wci.read call, but returns summarized rather than detailed data about the
				values in the database. Using wci.browse will usually be significantly
				faster than performing a similar wci.read call followed by
				aggregation.</para>
			
			<para>The function is overloaded, and exists in many different versions,
				depending on the return type required.</para>
			
			<sect2 id="sec:wci.browse.prereq">
				<title>Prerequisites</title>
				
				<itemizedlist>
					<listitem>
						<para>The user must be connected to the database</para>
					</listitem>
					<listitem>
						<para>The user must have access to group role wdb_read</para>
					</listitem>
					<listitem>
						<para>The user must have called wci.begin</para>
					</listitem>
				</itemizedlist>
				
			</sect2>
			
			<sect2 id="sec:wci.browse:syntax">
				<title>Syntax</title>
				
				<programlisting>
wci.browse
(
	dataProviders  ARRAY[text],
	place          text,
	referenceTime  text,
	validtime      text,
	parameters     ARRAY[text],
	level          text,
	dataVersions   ARRAY[integer],
	returnType     wci.browsedataprovider
)
			</programlisting>

				<programlisting>
wci.browse
(
	returnType     wci.browsedataprovider
)
			</programlisting>				
													
				<programlisting>
wci.browse
(
	dataProviders  ARRAY[text],
	place          text,
	referenceTime  text,
	validtime      text,
	parameters     ARRAY[text],
	level          text,
	dataVersions   ARRAY[integer],
	returnType     wci.browseplace
)
			</programlisting>

				<programlisting>
wci.browse
(
	returnType     wci.browseplace
)
			</programlisting>				
								
				<programlisting>
wci.browse
(
	dataProviders  ARRAY[text],
	place          text,
	referenceTime  text,
	validtime      text,
	parameters     ARRAY[text],
	level          text,
	dataVersions   ARRAY[integer],
	returnType     wci.browsereferencetime
)
			</programlisting>

				<programlisting>
wci.browse
(
	returnType     wci.browsereferencetime
)
			</programlisting>				
												
				<programlisting>
wci.browse
(
	dataProviders  ARRAY[text],
	place          text,
	referenceTime  text,
	validtime      text,
	parameters     ARRAY[text],
	level          text,
	dataVersions   ARRAY[integer],
	returnType     wci.browsevalidtime
)
			</programlisting>

				<programlisting>
wci.browse
(
	returnType     wci.browsevalidtime
)
			</programlisting>				
								
				<programlisting>
wci.browse
(
	dataProviders  ARRAY[text],
	place          text,
	referenceTime  text,
	validtime      text,
	parameters     ARRAY[text],
	level          text,
	dataVersions   ARRAY[integer],
	returnType     wci.browsevalueparameter
)
			</programlisting>

				<programlisting>
wci.browse
(
	returnType     wci.browsevalueparameter
)
			</programlisting>				
				
				<programlisting>
wci.browse
(
	dataProviders  ARRAY[text],
	place          text,
	referenceTime  text,
	validtime      text,
	parameters     ARRAY[text],
	level          text,
	dataVersions   ARRAY[integer],
	returnType     wci.browselevelparameter
)
			</programlisting>

				<programlisting>
wci.browse
(
	returnType     wci.browselevelparameter
)
			</programlisting>				
								
			</sect2>
			
			<sect2 id="sec:wci.browse.parameters">
				<title>Parameters</title>
				
				<para>All the wci.browse input parameters, except the returnType, are
					precisely the same as the input paramaters to a wci.read call (see
					Section <xref linkend="sec:wci.read:parameters"></xref>). Calling a function
					with only the "returnType" parameter specified is basically equivalent 
					to calling the wci.browse function with all NULLs (indicating that 
					all data is required). Be aware that trying to retrieve aggregates about
					all the data in a huge database can take a while. 
					</para>
				
				<para>The returnType specifies which of the six different types of
					summarized metadata the user wants to retrieve.</para>
				
			</sect2>
			
			<sect2 id="sec:wci.browse.result">
				<title>Expected Result</title>
				
				<para>Depending on the returnType specified:</para>
				
				<itemizedlist>
					<listitem>
						<para>wci.browsedataprovider</para>
						<para>This returns a list of the data providers that exist in the
							database for the parameter definitions given in the
							wci.browse call and the utilized namespace. For each
							dataprovider, the number of data records and the earliest and
							latest referencetimes that exist for that data value is also
							listed.</para>
					</listitem>
					<listitem>
						<para>wci.browseplace</para>
						<para>This returns a list of the place definitions that exist in
							the database for the parameter definitions given by the
							wci.browse call and the used namespace. For each place
							definition, the number of data records in the database are
							listed.</para>
					</listitem>
					<listitem>
						<para>wci.browsereferencetime</para>
						<para>This returns a list of the referencetimes that exist in the
							database for the parameter definitions given by the
							wci.browse call. For each referencetime, the number of data
							records in the database are listed.</para>
					</listitem>
					<listitem>
						<para>wci.browsevalidtime</para>
						<para>This returns a list of the validtimes that exist in the
							database for the parameter definitions given by the
							wci.browse call. For each validtime, the number of data
							records in the database are listed.</para>
					</listitem>
					<listitem>
						<para>wci.browsevalueparameter</para>
						<para>This returns a list of the value parameters that exist in the
							database for the parameter definitions given by the
							wci.browse call and the used namespace. For each
							valueparameter, the number of data records in the database
							are listed.</para>
					</listitem>
					<listitem>
						<para>wci.browselevelparameter</para>
						<para>This returns a list of the level parameters that exist in the
							database for the parameter definitions given by the
							wci.browse call and the utilized namespace. For each level
							parameter, the number of data records in the database are
							listed.</para>
					</listitem>
				</itemizedlist>
			</sect2>
			
			<sect2 id="sec:wci.browse.example">
				<title>Example</title>
				
				<para>The following browse query could be used to retrieve the data provider names 
					of all data providers in the database.</para>
				
				<programlisting>
SELECT * FROM wci.browse ( NULL::wci.browsedataprovider );					
				</programlisting>
				
				<para>The user might then utilize a result from this query to ask a 
					follow-up determining the reference times of  a specific data provider.</para>
				
				<programlisting>
SELECT * FROM wci.browse ( ARRAY[ 'hirlam' ], 
						   NULL, NULL, NULL, NULL, NULL,
					       NULL::wci.browsereferencetime );   					
				</programlisting>

				<para>The results from this query (a list of referencetimes), can then be used to
					drill down further into the data mass of the database. The following example 
					retrieves the list of parameters for the given data provider and reference time.
				</para>				
				
				<programlisting>
SELECT * FROM wci.browse ( ARRAY[ 'hirlam' ], NULL, 
						   'exact 1980-03-15 12:00:00+00', 
						   NULL, NULL, NULL,
					       NULL::wci.browsevalueparameter );
				</programlisting>
				
			</sect2>
			                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
			<sect2 id="sec:wci.browse.see">
				<title>See Also</title>
				
				<itemizedlist>
					<listitem>
						<para>wci.read</para>
					</listitem>
				</itemizedlist>
			</sect2>
			
		</sect1>				
				
		<sect1 id="sec:wci.end">
			<title>wci.end</title>
			
			<para>The function wci.end unsets any settings and frees up resources that may
				have been initialized by wci.begin.</para>
			
			<sect2 id="sec:wci.end.prereq">
				<title>Prerequisites</title>
				
				<itemizedlist>
					<listitem>
						<para>A connection must be open to the database</para>
					</listitem>
					<listitem>
						<para>The user must have successfully called wci.begin</para>
					</listitem>
				</itemizedlist>
			</sect2>
			
			<sect2 id="sec:wci.end.syntax">
				<title>Syntax</title>
				
				<programlisting>
wci.end 
(
)
</programlisting>
				
			</sect2>
			
			<sect2 id="sec:wci.end.parameters">
				<title>Parameters</title>
				
				<para>None.</para>
				
			</sect2>
			
			<sect2 id="sec:wci.end.result">
				<title>Expected Result</title>
				
				<para>No return expected.</para>
				
			</sect2>
			
			<sect2  id="sec:wci.end.example">
				<title>Example</title>
				
				<para>The wci.end function is just a simple functional call:</para>
				
				<programlisting>
SELECT wci.end ( );
</programlisting>				
			</sect2>
			
			<sect2 id="sec:wci.end.see">
				<title>See Also</title>
				
				<itemizedlist>
					<listitem>
						<para>wci.begin</para>
					</listitem>
				</itemizedlist>
			</sect2>
			
		</sect1>
	
		<sect1 id="sect:wci.info">
			<title>wci.info</title>
			
			<para>wci.info is the function utilized to retrieve the metadata in the
				database; for example, it can be used to return a lists of all parameters
				possible in the database, a list of the dataproviders registered, etc.
				Where wci.browse returns information about the data stored in the
				database, wci.info returns information about the data that is possible to
				store in the database. The function usually takes as its input a string as its
				search parameter. </para>
			
			<para>The function is overloaded, and exists in four different versions,
				depending on the return type required. Calling the function with a NULL in
				place of the search parameter will return the complete list of
				parameters.</para>
			
			<sect2>
				<title>Prerequisites</title>
				
				<itemizedlist>
					<listitem>
						<para>The user must be connected to the database</para>
					</listitem>
					<listitem>
						<para>The user must have access to group role wdb_read</para>
					</listitem>
					<listitem>
						<para>The user must have called wci.begin</para>
					</listitem>
				</itemizedlist>
				
			</sect2>
			
			<sect2>
				<title>Syntax</title>
				
				
				<programlisting>
wci.info
(
          dataProvider   text,
          returnType     wci.infodataprovider
)
			</programlisting>
				
				
				<programlisting>
wci.info
(
          place          text,
          returnType     wci.infoplace
)
			</programlisting>
				
				
				<programlisting>
wci.info
(
          valueParameter text,
          returnType     wci.infovalueparameter
)
			</programlisting>
				
				
				<programlisting>
wci.info
(
          levelParameter text,
          returnType     wci.infolevelparameter
)
			</programlisting>
				
			</sect2>
			
			<sect2>
				<title>Parameters</title>
				
				<table frame="all">
					<title>wci.info parameters</title>
					<tgroup cols="2">
						<colspec align="left"/>
						<colspec align="left"/>
						<thead>
							<row>
								<entry> Parameter </entry>
								<entry> Description </entry>
							</row>
						</thead>
						<tbody>
							<row>
								<entry>dataProvider</entry>
								<entry>A text string representing the data providers to
									list. Wild cards may be used in the string. NULL
									represents all.</entry>
							</row>
							<row>
								<entry>place</entry>
								<entry>A text string representing the place names to
									list. Wild cards may be used in the string. NULL
									represents all.</entry>
							</row>
							<row>
								<entry>valueParameter</entry>
								<entry>A text string representing the value parameters
									to list. Wild cards may be used in the string. NULL
									represents all.</entry>
							</row>
							<row>
								<entry>levelParameter</entry>
								<entry>A text string representing the level parameters
									to list. Wild cards may be used in the string. NULL
									represents all.</entry>
							</row>
							<row>
								<entry>returnType</entry>
								<entry>What type of data the user wants
									returned</entry>
							</row>
						</tbody>
					</tgroup>
				</table>
				
				<para>>Geospatial definitions are defined using well-known-text. Only
					POINTs and POLYGONs are currently supported.</para>
				
			</sect2>
			
			<sect2>
				<title>Expected Result</title>
				
				<para>Depending on the returnType specified:</para>
				
				<itemizedlist>
					<listitem>
						<para>wci.infodataprovider</para>
						<para>This return type gives detailed information on the data type specified.</para>
					</listitem>
					<listitem>
						<para>wci.infoplace</para>
					</listitem>
					<listitem>
						<para>wci.infovalueparameter</para>
					</listitem>
					<listitem>
						<para>wci.infolevelparameter</para>
					</listitem>
				</itemizedlist>
			</sect2>
			
			<sect2>
				<title>See Also</title>
				
				<itemizedlist>
					<listitem>
						<para>wci.read</para>
					</listitem>
				</itemizedlist>
			</sect2>
			
		</sect1>
		
		<sect1 id="sec:wci.fetch">
			<title>wci.fetch</title>
			
			<para>wci.fetch is the function used to retrieve binary data values from the database.
				The function takes a binary object ID returned by a wci.read call and returns
				a row containing the binary data (as bytea data) as well as additional relevant
				information required for the manipulation of the binary data.</para>
					
			<sect2 id="sec:wci.fetch:prerequisites">
				<title>Prerequisites</title>
				
				<itemizedlist>
					<listitem>
						<para>The user must be connected to the database</para>
					</listitem>
					<listitem>
						<para>The user must have access to group role wdb_read</para>
					</listitem>
					<listitem>
						<para>The user must have called wci.begin</para>
					</listitem>
				</itemizedlist>
				
			</sect2>
			
			<sect2 id="sec:wci.fetch:syntax">
				<title>Syntax</title>
				
				<programlisting>
wci.fetch
(
          objectid       bigint,
          returnType     wci.grid
)
			</programlisting>
				
			</sect2>
			
			<sect2 id="sec:wci.fetch:parameters">
				<title>Parameters</title>
				
				<table frame="all">
					<title>wci.fetch parameters</title>
					<tgroup cols="2">
						<colspec align="left"/>
						<colspec align="left"/>
						<thead>
							<row>
								<entry> Parameter </entry>
								<entry> Description </entry>
							</row>
						</thead>
						<tbody>
							<row>
								<entry>objectid</entry>
								<entry>The object ID of the binary object to be returned,
									as given by a wci.read call</entry>
							</row>
							<row>
								<entry>returnType</entry>
								<entry>What type of data the user wants
									returned</entry>
							</row>
						</tbody>
					</tgroup>
				</table>
				
			</sect2>
			
			<sect2 id="sec:wci.fetch:expected_result">
				<title>Expected Result</title>
				
				<para>Currently, the function always returns a:</para>
				
				<itemizedlist>
					<listitem>
						<para>wci.grid</para>
					</listitem>
				</itemizedlist>
			</sect2>
			
			<sect2 id="sec:wci.fetch:examples">
				<title>Examples</title>
				
				<para>The following query returns the grid referenced as 11702:</para>
				
			<programlisting>
SELECT * 
FROM wci.fetch ( 11702, 
				 NULL::wci.grid -- Return type
               )
		</programlisting>
			
			<para>The result is a single row containing the binary data of the grid itself (as a bytea),
				in addition to the number of points along the x and y axis of the grid, the distance 
				between grid increments, the starting positions of the x and y points in the original
				projection, and the PROJ.4 string defining the original projection of the grid.</para>
			
			</sect2>

			<sect2 id="sec:wci.fetch:see">
				<title>See Also</title>
				
				<itemizedlist>
					<listitem>
						<para>wci.read</para>
					</listitem>
					<listitem>
						<para>wci.write</para>
					</listitem>
				</itemizedlist>
			</sect2>
			
		</sect1>		
		
		<sect1 id="sec:wci.read">
			<title>wci.read</title>
			
			<para>wci.read is the function that fetches MHO data from the database, and as
				such is the core of the WDB Call Interface. The function takes the user's
				search parameters as input and returns data as either individual point, or
				as a reference to a complete data grid (a Grid ID - shortened as GId).</para>
			
			<para>The function is overloaded, and exists in two almost identical versions,
				depending on the return type required.</para>
			
			<sect2 id="sec:wci.read:prerequisites">
				<title>Prerequisites</title>
				
				<itemizedlist>
					<listitem>
						<para>The user must be connected to the database</para>
					</listitem>
					<listitem>
						<para>The user must have access to group role wdb_read</para>
					</listitem>
					<listitem>
						<para>The user must have called wci.begin</para>
					</listitem>
				</itemizedlist>
				
			</sect2>
			
			<sect2 id="sec:wci.read:syntax">
				<title>Syntax</title>
				
				<programlisting>
wci.read
(
          dataProviders  ARRAY[text],
          place          text,
          referenceTime  text,
          validtime      text,
          parameters     ARRAY[text],
          level          text,
          dataVersions   ARRAY[integer],
          returnType     wci.returnfloat
)
			</programlisting>
				
				<programlisting>
wci.read 
(
          dataProviders  ARRAY[text],
          place          text,
          referenceTime  text,
          validtime      text,
          parameters     ARRAY[text],
          level          text,
          dataVersions   ARRAY[integer],
          returnType     wci.returngid
)
			</programlisting>
				
			</sect2>
			
			<sect2 id="sec:wci.read:parameters">
				<title>Parameters</title>
				
				<table frame="all">
					<title>wci.read parameters</title>
					<tgroup cols="2">
						<colspec align="left"/>
						<colspec align="left"/>
						<thead>
							<row>
								<entry> Parameter </entry>
								<entry> Description </entry>
							</row>
						</thead>
						<tbody>
							<row>
								<entry>dataProviders</entry>
								<entry>List of data providers for the MHO data to be
									retrieved</entry>
							</row>
							<row>
								<entry>place</entry>
								<entry>A text string containing either a geometry
									describing the geographic locations that the user
									is interested in retrieving data for (formatted
									using well-known-text) or a placename. The string
									may optionally be prefixed with a place
									interpolation description.</entry>
							</row>
							<row>
								<entry>referenceTime</entry>
								<entry>When the MHO data was created</entry>
							</row>
							<row>
								<entry>validtime</entry>
								<entry>What time is the MHO data valid for</entry>
							</row>
							<row>
								<entry>parameters</entry>
								<entry>What MHO-parameters the user is interested in
									retrieving</entry>
							</row>
							<row>
								<entry>level</entry>
								<entry>What level (altitude/depth) the data is located
									at</entry>
							</row>
							<row>
								<entry>dataVersion</entry>
								<entry>What version of the data should be
									returned</entry>
							</row>
							<row>
								<entry>returnType</entry>
								<entry>What type of data the user wants
									returned</entry>
							</row>
						</tbody>
					</tgroup>
				</table>
				
				<para>>Geospatial definitions are defined using well-known-text. Only
					POINTs and POLYGONs are currently supported.</para>
				
			</sect2>
			
			<sect2 id="sec:wci.read:expected_result">
				<title>Expected Result</title>
				
				<para>Depending on the returnType specified:</para>
				
				<itemizedlist>
					<listitem>
						<para>wci.returnfloat</para>
					</listitem>
					<listitem>
						<para>wci.returngid</para>
					</listitem>
				</itemizedlist>
			</sect2>
			
			<sect2 id="sec:wci.read:examples">
				<title>Examples</title>
				
				<para>The following query returns Hirlam 8 data from the database using a
					wci.read:</para>
				
			<programlisting>
SELECT * 
FROM wci.READ ( ARRAY['Hirlam norway'], -- Data provider name
               'POINT(10 60)', -- Geometry
               '1980-04-05 12:00:00',  -- Reference time
               'inside 1980-04-06 00:00:00 TO 1980-04-07 00:00:00', --Valid time
               ARRAY['air pressure', 'air temperature'], -- Parameter
               NULL, -- Level
               ARRAY[-1],  -- Data version
               NULL::wci.returnFloat -- Return type
             )
		</programlisting>
			
			<para>The above query returns Hirlam 8 data pressure and temperature data for 
				the point closest to 10 degrees East, 60 degrees North that is valid for
				the twenty four hour time period of the 6th of April, 1980 and which was
				created (has the reference time) for the 5th of April, 12:00. The query returns
				all data that fulfills the above qualifications regardless of level, but only 
				the latest version (dataversion) of the data available.	Values will be returned 
				as point data.</para>
			
			</sect2>

			<sect2 id="sec:wci.read:see">
				<title>See Also</title>
				
				<itemizedlist>
					<listitem>
						<para>wci.begin</para>
					</listitem>
					<listitem>
						<para>wci.end</para>
					</listitem>
					<listitem>
						<para>wci.fetch</para>
					</listitem>
					<listitem>
						<para>wci.write</para>
					</listitem>
				</itemizedlist>
			</sect2>
			
		</sect1>		
		
		<sect1>
			<title>wci.write</title>
			
			<para>wci.write is function that can be utilized to write MHO data into the
				database.</para>
			
			<para>The function is overloaded, and exists in several different versions
				depending on the input utilized.</para>
			
			<sect2>
				<title>Prerequisites</title>
				
				<itemizedlist>
					<listitem>
						<para>The user must be connected to the database</para>
					</listitem>
					<listitem>
						<para>The user must have access to group role wdb_write</para>
					</listitem>
					<listitem>
						<para>The user must have called wci.begin</para>
					</listitem>
				</itemizedlist>
				
			</sect2>
			
			<sect2>
				<title>Syntax</title>				
				
				<programlisting>
wci.write
(
	value          gid,
	placename      text,
	referencetime  timestamp without time zone,
	validtimerom   timestamp without time zone,
	validtimeto    timestamp without time zone
	valueparameter text,
	levelparameter text,
	levelFrom      float,
	levelTo        float 
)
</programlisting>

				<programlisting>
wci.write
(
	value          gid,
	placename      text,
	referencetime  timestamp without time zone,
	validtimerom   timestamp without time zone,
	validtimeto    timestamp without time zone
	valueparameter text,
	levelparameter text,
	levelFrom      float,
	levelTo        float 
)
</programlisting>
				
				
				<programlisting>	
wci.write
(
          row           wci.returnGid
)
</programlisting>
				
			</sect2>
			
			<sect2>
				<title>Parameters</title>
				
				<table frame="all">
					<title>wci.write parameters</title>
					<tgroup cols="2">
						<colspec align="left"/>
						<colspec align="left"/>
						<thead>
							<row>
								<entry> Parameter </entry>
								<entry> Description </entry>
							</row>
						</thead>
						<tbody>
							<row>
								<entry>value</entry>
								<entry>The OID value to be retrieved</entry>
							</row>
							<row>
								<entry>placename</entry>
								<entry>A text string identifying the geographical
									location that the data is being inserted
									for</entry>
							</row>
							<row>
								<entry>referenceTime</entry>
								<entry>When the MHO data was created</entry>
							</row>
							<row>
								<entry>validtimefrom</entry>
								<entry>What time is the MHO data valid for; starting
									time</entry>
							</row>
							<row>
								<entry>validtimefrom</entry>
								<entry>What time is the MHO data valid for; ending
									time</entry>
							</row>
							<row>
								<entry>valueparameter</entry>
								<entry>What MHO-parameters the user is interested in
									retrieving</entry>
							</row>
							<row>
								<entry>levelparameter</entry>
								<entry>The parameter that describes the level
									designation</entry>
							</row>
							<row>
								<entry>levelFrom</entry>
								<entry>What level (altitude/depth) the data is located
									at; starting point</entry>
							</row>
							<row>
								<entry>levelTo</entry>
								<entry>What level (altitude/depth) the data is located
									at; ending point</entry>
							</row>
							<row>
								<entry>row</entry>
								<entry>A wci.returnOid row. This function allows the
									user to take the result a query and write the same (or a
									slightly modified row) easily into the
									database.</entry>
							</row>
						</tbody>
					</tgroup>
				</table>
				
			</sect2>
			
			<sect2>
				<title>Expected Result</title>
				
				<para>The valueid of the inserted row.</para>
				
			</sect2>
			
			<sect2>
				<title>See Also</title>
				
				<itemizedlist>
					<listitem>
						<para>wci.read</para>
					</listitem>
					<listitem>
						<para>wci.begin</para>
					</listitem>
					<listitem>
						<para>wci.end</para>
					</listitem>
				</itemizedlist>
			</sect2>
			
		</sect1>
		
		
	</chapter>
	
	<chapter>
		<title>Data Type Reference</title>
		
		<para>This section provides an overview of the data types that are returned from the
			database through WCI; in particular the return rows used by the wci.read and
			wci.write calls.</para>
		
	<sect1>
			<title>wci.browsedataprovider</title>
			
			<para>The wci.browsedataprovider data type is a simple row type used to
				return summarized information about the data providers of the rows
				currently stored in the database. The following table
				describes the attributes.</para>
			
			<table frame="all">
				<title>wci.browsedataprovider</title>
				<tgroup cols="3">
					<colspec align="center"/>
					<colspec align="left"/>
					<colspec align="left"/>
					<thead>
						<row>
							<entry> Order </entry>
							<entry> Attribute </entry>
							<entry> Description </entry>
						</row>
					</thead>
					<tbody>
						<row>
							<entry>0</entry>
							<entry>dataprovidername</entry>
							<entry>The name of the data provider that the summary information is about.</entry>
						</row>
						<row>
							<entry>1</entry>
							<entry>referencetimefrom</entry>
							<entry>The earliest referencetime in the database for the dataprovider for which there exists data.</entry>
						</row>
						<row>
							<entry>2</entry>
							<entry>referencetimeto</entry>
							<entry>The latest referencetime in the database for the dataprovider for which there exists data.</entry>
						</row>
						<row>
							<entry>3</entry>
							<entry>numberoftuples</entry>
							<entry>The number of data rows that exist in the database for the given dataprovider.</entry>
						</row>
					</tbody>
				</tgroup>
			</table>
		</sect1>

	<sect1>
			
				<title>wci.browseplace</title>
			
			<para>The wci.browseplace data type is a simple row type used to
				return summarized information about the placenames of the rows
				currently stored in the database. The following table
				describes the attributes.</para>
			<table frame="all">
				<title>wci.browseplace</title>
				<tgroup cols="3">
					<colspec align="center"/>
					<colspec align="left"/>
					<colspec align="left"/>
					<thead>
						<row>
							<entry> Order </entry>
							<entry> Attribute </entry>
							<entry> Description </entry>
						</row>
					</thead>
					<tbody>
						<row>
							<entry>0</entry>
							<entry>placename</entry>
							<entry>The name of the placedefinition that the summary information is about.</entry>
						</row>
						<row>
							<entry>1</entry>
							<entry>referencetimefrom</entry>
							<entry>The earliest referencetime in the database for the placename for which there exists data.</entry>
						</row>
						<row>
							<entry>2</entry>
							<entry>referencetimeto</entry>
							<entry>The latest referencetime in the database for the placename for which there exists data.</entry>
						</row>
						<row>
							<entry>3</entry>
							<entry>numberoftuples</entry>
							<entry>The number of data rows that exist in the database for the given placename.</entry>
						</row>
					</tbody>
				</tgroup>
			</table>
		</sect1>

		<sect1>
			<title>wci.browsereferencetime</title>
			
			<para>The wci.browsereferencetime data type is a simple row type used to
				return summarized information about the referencetime of the rows
				currently stored in the database. The following table
				describes the attributes.</para>
			
			<table frame="all">
				<title>wci.browsereferencetime</title>
				<tgroup cols="3">
					<colspec align="center"/>
					<colspec align="left"/>
					<colspec align="left"/>
					<thead>
						<row>
							<entry> Order </entry>
							<entry> Attribute </entry>
							<entry> Description </entry>
						</row>
					</thead>
					<tbody>
						<row>
							<entry>0</entry>
							<entry>referencetime</entry>
							<entry>The reference time that the summary information is about.</entry>
						</row>
						<row>
							<entry>1</entry>
							<entry>numberoftuples</entry>
							<entry>The number of data rows that exist in the database for the given referencetime.</entry>
						</row>
					</tbody>
				</tgroup>
			</table>
		</sect1>

			<sect1>
			<title>wci.browsevalidtime</title>
			
			<para>The wci.browsevalidtime data type is a simple row type used to
				return summarized information about the validtime of the rows
				currently stored in the database. The following table
				describes the attributes.</para>
			
			<table frame="all">
				<title>wci.browsevalidtime</title>
				<tgroup cols="3">
					<colspec align="center"/>
					<colspec align="left"/>
					<colspec align="left"/>
					<thead>
						<row>
							<entry> Order </entry>
							<entry> Attribute </entry>
							<entry> Description </entry>
						</row>
					</thead>
					<tbody>
						<row>
							<entry>0</entry>
							<entry>validtimefrom</entry>
							<entry>The name of the placedefinition that the summary information is about.</entry>
						</row>
						<row>
							<entry>1</entry>
							<entry>validtimeto</entry>
							<entry>The name of the placedefinition that the summary information is about.</entry>
						</row>
						<row>
							<entry>2</entry>
							<entry>numberoftuples</entry>
							<entry>The number of data rows that exist in the database for the given placename.</entry>
						</row>
					</tbody>
				</tgroup>
			</table>
		</sect1>
<!--
					<listitem>
						<para>wci.browsevalidtime</para>
						<para>This returns a list of the validtimes that exist in the
							database for the parameter definitions given by the
							wci.browse call. For each validtime, the number of data
							records in the database are listed.</para>
					</listitem>
					<listitem>
						<para>wci.browsevalueparameter</para>
						<para>This returns a list of the value parameters that exist in the
							database for the parameter definitions given by the
							wci.browse call and the used namespace. For each
							valueparameter, the number of data records in the database
							are listed.</para>
					</listitem>
					<listitem>
						<para>wci.browselevelparameter</para>
						<para>This returns a list of the level parameters that exist in the
							database for the parameter definitions given by the
							wci.browse call and the utilized namespace. For each level
							parameter, the number of data records in the database are
							listed.</para>
					</listitem>
				<itemizedlist>
					<listitem>
						<para>wci.infodataprovider</para>
					</listitem>
					<listitem>
						<para>wci.infoplace</para>
					</listitem>
					<listitem>
						<para>wci.infovalueparameter</para>
					</listitem>
					<listitem>
						<para>wci.infolevelparameter</para>
					</listitem>
				</itemizedlist>
	
		-->
	<sect1>
			<title>wci.returnFloat</title>
			
			<para>The wci.returnFloat data type is a simple row type used for returning
				floating-point data to the user from the wci.read call. The following table
				describes the attributes that are returned from wci.returnFloat;
				including the ordering of the attributes in the type.</para>
			
			<table frame="all">
				<title>wci.returnFloat</title>
				<tgroup cols="3">
					<colspec align="center"/>
					<colspec align="left"/>
					<colspec align="left"/>
					<thead>
						<row>
							<entry> Order </entry>
							<entry> Attribute </entry>
							<entry> Description </entry>
						</row>
					</thead>
					<tbody>
						<row>
							<entry>0</entry>
							<entry>value</entry>
							<entry>The floating point value returned by the
								query</entry>
						</row>
						<row>
							<entry>1</entry>
							<entry>data provider name</entry>
							<entry>The name of the data provider of the value (as defined
								within the dataprovidernamespace selected)</entry>
						</row>
						<row>
							<entry>2</entry>
							<entry>place name</entry>
							<entry>The name of the grid definition selected (as defined
								within the placenamespace selected). If the point value
								is being returned from a grid, the name returned will be
								that of the grid.</entry>
						</row>
						<row>
							<entry>3</entry>
							<entry>place geometry</entry>
							<entry>The POINT geometry definition of the value
								returned.</entry>
						</row>
						<row>
							<entry>4</entry>
							<entry>referencetime</entry>
							<entry>The time of reference for the value returned</entry>
						</row>
						<row>
							<entry>5</entry>
							<entry>validtime from</entry>
							<entry>The first point in time for which the value is
								valid</entry>
						</row>
						<row>
							<entry>6</entry>
							<entry>validtime to</entry>
							<entry>The last point in time for which the value is
								valid</entry>
						</row>
						<row>
							<entry>7</entry>
							<entry>value parameter name</entry>
							<entry>The parameter name for the value returned (as defined
								within the parameter name space selected)</entry>
						</row>
						<row>
							<entry>8</entry>
							<entry>value parameter unit</entry>
							<entry>The measurement unit for the value returned</entry>
						</row>
						<row>
							<entry>9</entry>
							<entry>level parameter name</entry>
							<entry>The parameter name for the level of the value returned
								(as defined within the parameter name space
								selected)</entry>
						</row>
						<row>
							<entry>10</entry>
							<entry>level unit name</entry>
							<entry>The measurement unit for the level of the value
								returned</entry>
						</row>
						<row>
							<entry>11</entry>
							<entry>level from</entry>
							<entry>The lower value of the level</entry>
						</row>
						<row>
							<entry>12</entry>
							<entry>level</entry>
							<entry>The upper of the level</entry>
						</row>
						<row>
							<entry>13</entry>
							<entry>data version</entry>
							<entry>The data version of the value. Data version is
								utilized for two separate purposes; to indicate
								different version of the same data (i.e., to allow
								corrections and edits to co-exist in the database) and
								for perturbed versions of the same data (e.g., ensemble
								members).</entry>
						</row>
						<row>
							<entry>14</entry>
							<entry>confidence code</entry>
							<entry>Quality marker (not currently used)</entry>
						</row>
						<row>
							<entry>15</entry>
							<entry>value store time</entry>
							<entry>The time when the data was inserted into the
								database</entry>
						</row>
						<row>
							<entry>16</entry>
							<entry>value id</entry>
							<entry>The ID of the value within its value type. Together
								with valuetype, this costitutes a key of the WDB
								value</entry>
						</row>
						<row>
							<entry>17</entry>
							<entry>value type</entry>
							<entry>The type of the value returned. Together with the
								valueid, this constitutes a key of the WDB value</entry>
						</row>
					</tbody>
				</tgroup>
			</table>
			
		</sect1>
		
		<sect1>
			<title>wci.returnOid</title>
			
			<para>The wci.returnOid data type is a simple row type used for returning data to
				the user from the wci.read call. The following table describes the
				attributes that are returned from wci.returnOid; including the ordering
				of the attributes in the type.</para>
			
			<table frame="all">
				<title>wci.returnOid</title>
				<tgroup cols="3">
					<colspec align="center"/>
					<colspec align="left"/>
					<colspec align="left"/>
					<thead>
						<row>
							<entry> Order </entry>
							<entry> Attribute </entry>
							<entry> Description </entry>
						</row>
					</thead>
					<tbody>
						<row>
							<entry>0</entry>
							<entry>value</entry>
							<entry>The object ID (OID) of the value being
								returned</entry>
						</row>
						<row>
							<entry>1</entry>
							<entry>data provider name</entry>
							<entry>The name of the data provider of the value (as defined
								within the dataprovidernamespace selected)</entry>
						</row>
						<row>
							<entry>2</entry>
							<entry>place name</entry>
							<entry>The name of the grid definition selected (as defined
								within the placenamespace selected). The place name can
								be then be used to retrieve the original grid definition
								of the grid, if needed</entry>
						</row>
						<row>
							<entry>3</entry>
							<entry>place geometry</entry>
							<entry>The geometry definition of the value returned. This
								is less useful for rotated grids, as the coordinates will
								be in regular WGS84.</entry>
						</row>
						<row>
							<entry>4</entry>
							<entry>referencetime</entry>
							<entry>The time of reference for the value returned</entry>
						</row>
						<row>
							<entry>5</entry>
							<entry>validtime from</entry>
							<entry>The first point in time for which the value is
								valid</entry>
						</row>
						<row>
							<entry>6</entry>
							<entry>validtime to</entry>
							<entry>The last point in time for which the value is
								valid</entry>
						</row>
						<row>
							<entry>7</entry>
							<entry>value parameter name</entry>
							<entry>The parameter name for the value returned (as defined
								within the parameter name space selected)</entry>
						</row>
						<row>
							<entry>8</entry>
							<entry>value parameter unit</entry>
							<entry>The measurement unit for the value returned</entry>
						</row>
						<row>
							<entry>9</entry>
							<entry>level parameter name</entry>
							<entry>The parameter name for the level of the value returned
								(as defined within the parameter name space
								selected)</entry>
						</row>
						<row>
							<entry>10</entry>
							<entry>level unit name</entry>
							<entry>The measurement unit for the level of the value
								returned</entry>
						</row>
						<row>
							<entry>11</entry>
							<entry>level from</entry>
							<entry>The lower value of the level</entry>
						</row>
						<row>
							<entry>12</entry>
							<entry>level</entry>
							<entry>The upper of the level</entry>
						</row>
						<row>
							<entry>13</entry>
							<entry>data version</entry>
							<entry>The data version of the value. Data version is
								utilized for two separate purposes; to indicate
								different version of the same data (i.e., to allow
								corrections and edits to co-exist in the database) and
								for perturbed versions of the same data (e.g., ensemble
								members).</entry>
						</row>
						<row>
							<entry>14</entry>
							<entry>confidence code</entry>
							<entry>Quality marker (not currently used)</entry>
						</row>
						<row>
							<entry>15</entry>
							<entry>value store time</entry>
							<entry>The time when the data was inserted into the
								database</entry>
						</row>
						<row>
							<entry>16</entry>
							<entry>value id</entry>
							<entry>The ID of the value within its value type. Together
								with valuetype, this costitutes a key of the WDB
								value</entry>
						</row>
						<row>
							<entry>17</entry>
							<entry>value type</entry>
							<entry>The type of the value returned. Together with the
								valueid, this constitutes a key of the WDB value</entry>
						</row>
					</tbody>
				</tgroup>
			</table>
			
		</sect1>

	</chapter>
	
	<!--			
	
	Data Types Reference & Data Retrieval
	Examples
	FAQ: Frequently Asked Questions
	Known Problems, Bugs, and Limitations
	
	-->
	
</book>
